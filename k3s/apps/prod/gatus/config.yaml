---
apiVersion: v1
kind: ConfigMap
metadata:
  name: gatus
  namespace: gatus
data:
  config.yaml: |
    metrics: true
    storage:
      type: postgres
      path: "${POSTGRES_CONNECTION_STRING}"

    alerting:
      telegram:
        token: "${TELEGRAM_BOT_TOKEN}"
        id: "${TELEGRAM_USER_ID}"

    endpoints:
      - name: IT - Tools
        url: "http://it-tools.it-tools.svc.cluster.local"
        interval: 300s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Miniflux
        url: "http://miniflux.miniflux.svc.cluster.local"
        interval: 300s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Paperless-ngx
        url: "http://paperless-ngx.paperless-ngx.svc.cluster.local"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Recipes
        url: "http://recipes.recipes.svc.cluster.local"
        interval: 300s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Vaultwarden
        url: "http://vaultwarden.vaultwarden.svc.cluster.local"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Jellyfin
        url: "http://jellyfin.jellyfin.svc.cluster.local"
        interval: 120s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Jellyseerr
        url: "http://jellyseerr.jellyseerr.svc.cluster.local"
        interval: 120s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Radarr
        url: "http://radarr.radarr.svc.cluster.local"
        interval: 120s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Sonarr
        url: "http://sonarr.sonarr.svc.cluster.local"
        interval: 120s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Prowlarr
        url: "http://prowlarr.prowlarr.svc.cluster.local"
        interval: 120s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Sabnzbd
        url: "http://sabnzbd.sabnzbd.svc.cluster.local"
        interval: 120s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Gotify
        url: "http://gotify.gotify.svc.cluster.local"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Portainer
        url: "http://portainer.portainer.svc.cluster.local"
        interval: 300s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Homarr
        url: "http://homarr.homarr.svc.cluster.local"
        interval: 300s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: pgAdmin
        url: "http://pgadmin.pgadmin.svc.cluster.local"
        interval: 300s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Apprise
        url: "http://apprise.apprise.svc.cluster.local"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Beszel
        url: "http://beszel.beszel.svc.cluster.local"
        interval: 30s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Redis
        url: "http://redis-master.redis.cluster.local"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Cert Manager
        url: "http://cert-manager.cert-manager.cluster.local"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Postgres (cnpg-rw)
        url: "tcp://cn-postgresql-cluster-rw.cnpg-system.svc.cluster.local:5432"
        interval: 60s
        conditions:
          - "[CONNECTED] == true"
          - "[RESPONSE_TIME] < 2000"
        alerts:
          - type: telegram

      - name: Postgres Backup (barman-cloud)
        url: "http://barman-cloud.cnpg-system.svc.cluster.local:9090/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Node k3s-server-1
        url: "https://192.168.0.60:10250/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Node k3s-server-2
        url: "https://192.168.0.61:10250/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Node k3s-server-3
        url: "https://192.168.0.62:10250/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Node k3s-agent-1
        url: "https://192.168.0.80:10250/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Node k3s-agent-2
        url: "https://192.168.0.81:10250/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Node k3s-agent-3
        url: "https://192.168.0.82:10250/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Node k3s-postgres-agent-1
        url: "https://192.168.0.90:10250/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Node k3s-postgres-agent-2
        url: "https://192.168.0.91:10250/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram

      - name: Node k3s-postgres-agent-3
        url: "https://192.168.0.92:10250/healthz"
        interval: 60s
        conditions:
          - "[STATUS] == 200"
        alerts:
          - type: telegram
